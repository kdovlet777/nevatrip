# Система бронирования билетов

## Описание

В данном проекте реализована система бронирования билетов для различных событий. Проект позволяет пользователям заказывать билеты на мероприятия, включая возможность выбора различных типов билетов, таких как взрослые, детские, льготные и групповые. Система обеспечивает уникальность штрих-кодов для каждого заказа и включает функционал для обработки ошибок при бронировании и подтверждении заказов.

## Структура базы данных

Для нормализации данных и обеспечения гибкости системы была изменена структура базы данных. Ниже представлены основные таблицы:

### Таблица `orders`

| Поле          | Тип         | Описание                                        |
|---------------|-------------|-------------------------------------------------|
| id            | INT         | Уникальный идентификатор заказа (первичный ключ) |
| event_id      | INT         | Идентификатор события, на которое куплены билеты |
| event_date    | DATETIME    | Дата и время события                           |
| created       | DATETIME    | Дата и время создания заказа                   |

### Таблица `ticket_types`

| Поле          | Тип         | Описание                                        |
|---------------|-------------|-------------------------------------------------|
| id            | INT         | Уникальный идентификатор типа билета (первичный ключ) |
| type_name     | VARCHAR(50) | Название типа билета (взрослый, детский, льготный, групповой) |
| price         | DECIMAL(10,2) | Цена билета                                    |

### Таблица `tickets`

| Поле          | Тип         | Описание                                        |
|---------------|-------------|-------------------------------------------------|
| id            | INT         | Уникальный идентификатор билета (первичный ключ) |
| order_id      | INT         | Идентификатор заказа, к которому принадлежит билет |
| type_id       | INT         | Идентификатор типа билета                       |
| barcode       | VARCHAR(120)| Уникальный штрих-код для каждого билета        |

## Основные функции

### Создание заказа

При создании заказа выполняются следующие шаги:

1. Генерация уникального штрих-кода.
2. Отправка запроса на бронирование на стороннее API.
3. В случае успешного бронирования отправляется запрос на подтверждение.
4. Если подтверждение успешно, информация о заказе и билетах сохраняется в базе данных.

### Проверка уникальности штрих-кода

Метод `isBarcodeUnique` проверяет, существует ли уже сгенерированный штрих-код в базе данных. Если штрих-код уникален, он может быть использован для нового заказа.

## Установка

1. Клонируйте репозиторий на свой локальный компьютер и перейдите в него:
    ```bash
    git clone https://github.com/kdovlet777/nevatrip.git
    cd nevatrip
2. Настройте переменные окружения как показано в .env.example и создайте свой .env файл
3. Запустите докер образ для работы сервера
    ```bash
    docker-compose up -d
4. Установите зависимости
    ```bash
    composer install

При открытии страницы обновляйте пока не увидете сообщение об успешном создании заказа